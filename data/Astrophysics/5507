While from the energetic point of view supernova remnants are viable sources of Galactic cosmic rays (CRs), the issue of whether they can accelerate protons up to a few PeV remains unsolved. Here we discuss particle acceleration at the forward shock of supernovae, and discuss the possibility that the current of escaping particles may excite a non-resonant instability that in turn leads to the formation of resonant modes that confine particles close to the shock, thereby increasing the maximum energy. This mechanism is at work throughout the expansion of the supernova explosion, from the ejecta dominated (ED) phase to the Sedov-Taylor (ST) phase. The transition from one stage to the other reflects in a break in the spectrum of injected particles. Because of their higher explosion rate, we focus our work on type II SNe expanding in the slow, dense wind, produced by the red super-giant progenitor stars. When the explosion occurs in such winds, the transition between the ED and the ST phase is likely to take place within a few tens of years. The highest energies are reached at even earlier times, when, however, a small fraction of the mass of ejecta has been processed. As a result, the spectrum of accelerated particles shows a break in the slope, at an energy that is the maximum energy (EM) achieved at the beginning of the ST phase. Above this characteristic energy, the spectrum becomes steeper but remains a power law rather than developing an exponential cutoff. An exponential cut is eventually present at much higher energies but it does not have a phenomenological relevance. We show that for parameters typical of type II supernovae, EM for protons can easily reach values in the PeV range, confirming that type II SNRs are the best candidate sources for CRs at the knee. From the point of view of implications of this scenario on the measured particle spectra, we have tried to fit KASCADE-Grande, ARGO -YBJ and YAC1-Tibet Array data with our model but we could not find any combination of the parameters that could explain all data sets. Indeed the recent measurement of the proton and helium spectra in the knee region, with the ARGO-YBJ and YAC1-Tibet Array, has made the situation very confused. These measurements suggest that the knee in the light component is at ∼650 TeV, appreciably below the knee in the overall spectrum. On one hand this finding would resolve the problem of reaching very high energies in supernovae, but on the other it would open a critical issue in the transition region between Galactic and extragalactic CRs. © 2015 Elsevier B.V. All rights reserved.