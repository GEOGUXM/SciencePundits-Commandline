The partition coefficient of carbon between Fe-rich alloy melt and silicate melt, DCmetal/silicate and solubility of C-O-H volatiles in reduced silicate melts are key parameters that need to be quantified in order to constrain the budget and origin of carbon in different planetary reservoirs and subsequent evolution of volatiles in magma oceans (MO) and silicate mantles. In this study, three sets of graphite-saturated experiments have been performed at 3 GPa and 1600 °C to investigate the effects of oxygen fugacity (fO2), sulfur, silicon, and water on the dissolution and partitioning of carbon between Fe-rich alloy melt and silicate melt. The results show that the presence of 0-5 wt% sulfur in alloy melt does not have considerable effect on carbon solubility (~5.6 wt%) in alloy melt, determined by electron microprobe, whereas the presence of 0-10 wt% silicon decreases the carbon solubility from ~5.6 wt% to 1.8 wt%. Carbon solubility (11-192 ppm) in silicate melt, determined by SIMS, is strongly controlled by fO2 and the bulk water content. Decreasing log fO2 from IW-0.6 to IW-4.7 or increasing bulk water content from 0.07 to 0.55 wt% results in significant increase of carbon solubility in silicate melt. Raman and FTIR spectroscopic analyses of silicate glasses show that the carbon species is mostly methane, which is further confirmed by the strong, positive correlation between the non-carbonate carbon and non-hydroxyl hydrogen in silicate melt. The DCmetal/silicate ranging from 180 to 4600 decreases with decreasing fO2 or increasing bulk water in silicate melt. In addition, increasing Si in alloy melt also decreases DCmetal/silicate.Our results demonstrate that fO2 and bulk water contents in silicate melt play an important role in determining the fractionation of carbon in planetary MO. A reduced, hydrous MO may have led to a considerable fraction of carbon retained in the silicate mantle, whereas an oxidized, dry MO may have lost almost its entire carbon into the core. If delivery of bulk Earth carbon predominantly occurred after &gt;90% of accretion, i.e., in a relatively oxidized MO (IW-2 to IW-1), then with applicable DCmetal/silicate&gt;1000, most early Earth carbon would also enter the segregating core. Finally, the predominance of methane in reduced silicate melt with fO2 below IW-1 also indicates that degassing of a hydrous, solidifying MO may have created a reduced early atmosphere, and degassing from lunar and Martian mantle may have released much more methane than carbon dioxide. © 2015 Elsevier B.V.