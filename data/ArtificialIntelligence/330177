This paper presents an advanced insulin bolus advisor for people with diabetes on multiple daily injections or insulin pump therapy. The proposed system, which runs on a smartphone, keeps the simplicity of a standard bolus calculator while enhancing its performance by providing more adaptability and flexibility. This is achieved by means of applying a retrospective optimization of the insulin bolus therapy using a novel combination of run-to-run (R2R) that uses intermittent continuous glucose monitoring data, and case-based reasoning (CBR). The validity of the proposed approach has been proven by in-silico studies using the FDA-accepted UVa-Padova type 1 diabetes simulator. Tests under more realistic in-silico scenarios are achieved by updating the simulator to emulate intrasubject insulin sensitivity variations and uncertainty in the capillarity measurements and carbohydrate intake. The CBR(R2R) algorithm performed well in simulations by significantly reducing the mean blood glucose, increasing the time in euglycemia and completely eliminating hypoglycaemia. Finally, compared to an R2R stand-alone version of the algorithm, the CBR(R2R) algorithm performed better in both adults and adolescent populations, proving the benefit of the utilization of CBR. In particular, the mean blood glucose improved from 166 ± 39 to 150 ± 16 in the adult populations (p = 0.03) and from 167 ± 25 to 162 ± 23 in the adolescent population (p = 0.06). In addition, CBR(R2R) was able to completely eliminate hypoglycaemia, while the R2R alone was not able to do it in the adolescent population. 2168-2194 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.